<!DOCTYPE html>
<html lang="id" class="h-full">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kartu Member - Beauty Care</title>
    <script src="https://cdn.tailwindcss.com/3.4.17"></script>
    <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              'pink-soft': '#f8e8f0',
              'pink-accent': '#f0c2d4',
              'brown-text': '#8b4513',
              'blue-button': '#6bb6ff'
            }
          }
        }
      }
    </script>
  </head>
  <body class="min-h-full">
    <div class="flex items-center justify-center p-4">
            
        <!-- Membership Card -->
        <div class="space-y-4">
            <h2 class="text-lg lg:text-xl font-semibold text-gray-600 uppercase tracking-wide">
            Kartu Member
            </h2>

            <div 
                class="
                    flex
                    overflow-hidden
                    grid
                    grid-cols-1
                    md:grid-cols-2
                    gap-4
                    p-2" 
                id="card-action" 
            >
            
                <div id="member-info" class="border-2 border-solid">
                    <div class="flex w-[325px] h-[204px] rounded-2xl">
                        <!-- Left section - Cream/Gray with decorative elements -->
                        <div class="w-2/5 bg-white relative flex flex-col items-center justify-center">
                            <!-- Updated floral corner decoration with new image -->
                            <!-- Top left corner ornament -->
                            <img src="https://hebbkx1anhila5yf.public.blob.vercel-storage.com/2-UwFgl1pNhUTNZlWDFyqB2gCYHxKjiY.png" alt="Floral corner decoration" class="absolute mt-[-120px] ml-[-10px] object-contain rotate-180">
                            
                            <!-- Bottom left corner ornament -->
                            <img src="https://hebbkx1anhila5yf.public.blob.vercel-storage.com/2-UwFgl1pNhUTNZlWDFyqB2gCYHxKjiY.png" alt="Floral corner decoration" class="absolute mb-[-130px] ml-[-10px] object-contain rotate-90" style="transform: scaleX(-1);">
                            
                            <!-- Logo with woman face and BEAUTIFY SOUL text -->
                            <img src="https://hebbkx1anhila5yf.public.blob.vercel-storage.com/Untitled%20design%20%2827%29-5yRsa9mSKxbCnooucB9HuodMzyY53U.png" alt="Beautify Soul Logo" class="w-5/6 h-3/6 object-contain ms-2">
                        </div>
                        
                        <!-- Right section - Pink with card details -->
                        <div class="w-3/5 bg-[#ffddd1] relative p-6 flex flex-col justify-center">
                            <!-- Updated floral corner decoration with new image -->
                            <!-- Top right corner ornament -->
                            <img src="https://hebbkx1anhila5yf.public.blob.vercel-storage.com/2-UwFgl1pNhUTNZlWDFyqB2gCYHxKjiY.png" alt="Floral corner decoration" style="transform: scaleY(-1);" class="absolute mt-[-120px] ms-[50px] md:ms-[60px] object-contain w-3/5">
                            
                            <!-- Bottom right corner ornament -->
                            <img src="https://hebbkx1anhila5yf.public.blob.vercel-storage.com/2-UwFgl1pNhUTNZlWDFyqB2gCYHxKjiY.png" alt="Floral corner decoration" class="absolute mb-[-130px] ms-[50px] md:ms-[60px] object-contain w-3/5">
                            
                            <!-- Card title -->
                            <h3 class="text-md md:text-2xl font-bold text-gray-800 text-center">MEMBER CARD</h3>
                            
                            <!-- ID field -->
                            <div class="space-y-2">
                                <div class="text-xs bg-gray-400 bg-opacity-50 rounded-full px-4 py-2 text-gray-800 font-medium text-center" id="member-id">
    <!--                                             220707001-0003 -->
                                </div>
                            </div>
                        
                        </div>
                    </div>
                </div>


                <div class="border-2 border-solid">
                    <div id="qr-code-pv" class="flex p-5 items-center justify-center bg-[#ffddd1] w-[325px] h-[204px]">

                        <div class="bg-white rounded-2xl">
                            <div class="flex justify-center">
                                <img src="https://hebbkx1anhila5yf.public.blob.vercel-storage.com/Untitled%20design%20%2827%29-5yRsa9mSKxbCnooucB9HuodMzyY53U.png" alt="Floral corner decoration" class="absolute w-[69px] mt-2 ms-[-170px] object-contain">
                                    
                                <img id="member-barcode" class="img-barcode w-[77px] mt-1" src="" />
                            </div>
                            
                            <div class="flex justify-center mt-2">
                            <p id="member-id-qr" class="text-center">Save the card and collect point every you buy product</p>
                            </div>
                        </div>
                    
                    </div>
                </div>
            
            </div>
        </div>

    </div>
  
    <script>
  
      const params = new URLSearchParams(window.location.search);
      // console.log(params.get('id'))
      const id = params.get("id");
  
      if (!id) {
        alert("Id Required");
      }
  
      // Fetch member data from Google Apps Script
      const apiUrl = `https://script.google.com/macros/s/AKfycbx8r4UzQmYHVEno-Xez3XfKII0EfI4YGSrm4BdP6OqMvMIEMHUfhs0brADxGG_8XjH7/exec?id=${id}`;
  
  
      fetch(apiUrl)
        .then(res => res.json())
        .then(member => {
            document.getElementById('member-id').textContent = `${member.id}`;
            document.getElementById('member-barcode').src = member.barcodeUrl || '';
            // document.getElementById('member-id-qr').textContent = member.id;
            const img = document.getElementById('member-barcode');
            img.src = member.barcodeUrl || '';

            // Wait for image load before printing
            img.onload = () => {
                window.print();
            };

            // If image fails, still show print dialog
            img.onerror = () => {
                console.warn("QR Code failed to load");
                window.print();
            };
        })
        .catch(err => {
          console.error("Error fetching data:", err);
        });
    </script>

  </body>
</html>
